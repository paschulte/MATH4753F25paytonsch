---
title: "Lab 3: MATH 4753"
author: "Payton Schulte"
date: "`r Sys.Date()`"
output: 
  html_document:
    toc: yes
    toc_float: yes
    theme: spacelab
    highlight: pygments
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Task 1 - Sorting Files into Directories
```{r}
getwd()
```


# Task 2 - Reading Data into R
```{r}
# Reads in SPRUCE csv
spruce.df = read.csv("SPRUCE.csv")
head(spruce.df)
```


# Task 3 - Creating Scatter Plot from Data
```{r}
# Creates scatter plot from spruce.df data
plot(Height ~ BHDiameter, main = "Tree Height vs BHDiameter", 
     xlab = "Breast Height Diamter (cm)", ylab = "Height of Tree (m)", 
     bg = "Blue", pch = 21, cex = 1.2, 
     ylim = c(0, max(Height) * 1.1), xlim = c(0, max(BHDiameter) * 1.1), data = spruce.df)
```

### Is there a straight line relationship?
> There is a slight linear aspect to the plot, but a modest curve may better represent the data.

### Trendscatter Plots for Values f = 0.5, 0.6, 0.7
```{r}
# Loads in library s20x
library(s20x)
```
```{r}
layout = layout(matrix(1:3, nr=1, nc=3, byrow=TRUE))
# Plot for 0.5
tsplot1 = trendscatter(Height~BHDiameter, f=0.5, data=spruce.df)
# Plot for 0.6
tsplot2 = trendscatter(Height~BHDiameter, f=0.6, data=spruce.df)
# Plot for 0.7
tsplot3 = trendscatter(Height~BHDiameter, f=0.7, data=spruce.df)
```

### Linear Model
```{r}
spruce.lm = with(spruce.df, lm(Height ~ BHDiameter))
summary(spruce.lm)
```

### Scatter Plot with Least Square Regression Line
```{r}
# Creates scatter plot from spruce.df data
with (spruce.df, 
      plot(Height ~ BHDiameter, main = "Tree Height vs BHDiameter", 
     xlab = "Breast Height Diamter (cm)", ylab = "Height of Tree (m)", 
     bg = "Blue", pch = 21, cex = 1.2, 
     ylim = c(0, max(Height) * 1.1), xlim = c(0, max(BHDiameter) * 1.1), data = spruce.df))
# Adds least squares regression line
abline(spruce.lm)
```

### Is The Straight Line Appropriate?
> I think that the straight line is appropriate, but a curve would fit the data better and be more accurate.


# Task 4 - Scatter Plots with Calculations
```{r}
# Creates 4 equal areas that are labeled
layout = layout(matrix(1:4, nr=2, nc=2, byrow=TRUE))
layout.show(4)
```

```{r}
layout(matrix(1:4, nrow = 2, ncol = 2, byrow = TRUE))
# Plot 1
# Scatter plot with fitted line
with (spruce.df, 
      plot(Height ~ BHDiameter, 
      main = "Tree Height vs BHDiameter", 
      xlab = "Breast Height Diamter (cm)", 
      ylab = "Height of Tree (m)", 
      bg = "Blue", 
      pch = 21, 
      cex = 1.2, 
      ylim = c(0, max(Height) * 1.1), 
      xlim = c(0, max(BHDiameter) * 1.1), 
      data = spruce.df))
abline(spruce.lm)


# Plot 2
# Creates scatter plot
with (spruce.df, 
      plot(Height ~ BHDiameter, 
      main = "RSS Plot", 
      xlab = "Breast Height Diamter (cm)", 
      ylab = "Height of Tree (m)", 
      bg = "Blue", 
      pch = 21, 
      cex = 1.2, 
      ylim = c(0, max(Height) * 1.1), 
      xlim = c(0, max(BHDiameter) * 1.1), 
      data = spruce.df))
# Creates residual line segments
yhat=fitted(spruce.lm)
# Adds residual line segments
with(spruce.df, {segments(BHDiameter, Height, BHDiameter, yhat)})
# Adds fitted line 
abline(spruce.lm)


# Plot 3
# Creates scatter plot
with (spruce.df, 
      plot(Height ~ BHDiameter, 
      main = "MSS Plot", 
      xlab = "Breast Height Diamter (cm)", 
      ylab = "Height of Tree (m)", 
      bg = "Blue", 
      pch = 21, 
      cex = 1.2, 
      ylim = c(0, max(Height) * 1.1), 
      xlim = c(0, max(BHDiameter) * 1.1), 
      data = spruce.df))
# Adds residual line segments
with(spruce.df, abline(h = mean(Height)))
with(spruce.df, segments(BHDiameter, mean(Height), BHDiameter, yhat, col = "Red"))
# Adds fitted line 
abline(spruce.lm)


# Plot 4
# Creates scatter plot 
with (spruce.df, 
      plot(Height ~ BHDiameter, 
      main = "TSS Plot", 
      xlab = "Breast Height Diamter (cm)", 
      ylab = "Height of Tree (m)", 
      bg = "Blue", 
      pch = 21, 
      cex = 1.2, 
      ylim = c(0, max(Height) * 1.1), 
      xlim = c(0, max(BHDiameter) * 1.1), 
      data = spruce.df))
# Adds total deviation line segments
with(spruce.df, abline(h = mean(Height)))
with(spruce.df, segments(BHDiameter, Height, BHDiameter, mean(Height), col = "Green"))
```

### Calculated TSS, MSS, and RSS
>1. RSS (residual sum of squares) = **95.70**
```{r}
RSS = with(spruce.df, sum((Height - yhat)^2))
RSS
```
>2. MSS (model sum of squares) = **183.24**
```{r}
MSS = with(spruce.df, sum((yhat - mean(Height))^2))
MSS
```
>3. TSS (total sum of squares) = **278.95**
```{r}
TSS = with(spruce.df, sum((Height - mean(Height))^2))
TSS
```

### Calculated MSS/TSS
>1. MSS/TSS = **0.66**
```{r}
MSS/TSS
```
> This value is used to see how fitting the linear model is for our data. The relatively low value shows that a straight line is not the best for representing the data. 

### Does TSS = MSS + RSS?
> MSS + RSS = **278.95**
> TSS = **278.95**
```{r}
MSS + RSS
TSS
```
> **<u>Yes</u>**, MSS + RSS does equal TSS


# Task 5 - spruce.lm Information
```{r}
# Summarizes spruce.lm
summary(spruce.lm)
```
```{r}
#Get coefficients
coef(spruce.lm)
```
>1. Slope: **9.1468390**
>2. Intercept: **0.4814743**
>3. Equation of fitted line: $Height = (0.4814743)x + 9.1468390$
>4. Predicted height of spruce when diamter is 15, 18, and 20 cm

* 15 cm - **16.37 m**
* 18 cm - **17.81 m**
* 20 cm - **18.78 m**
```{r}
predict(spruce.lm, data.frame(BHDiameter = c(15, 18, 20)))
```

# Task 6 - Plot of Height vs. Diameter
```{r}
library(ggplot2)
g = ggplot(spruce.df, aes(x = BHDiameter, y = Height, color = BHDiameter))
g = g + geom_point() + geom_line() + geom_smooth(method = "lm")
g = g + ggtitle("Tree Height vs. Breast Height Diameter") + 
  theme(plot.title = element_text(hjust = 0.5))
g
```

# Task 7 - Interactive Plot Images
</center>
>1. Linear Regression Line Graph
```{r}
knitr::include_graphics(path = "TrendLine_Lab3.png")
```

> 2. Points Alone Graph
```{r}
knitr::include_graphics(path = "PointsAlone_Lab3.png")
```

>3. Points Joined with Line Segments Graph
```{r}
knitr::include_graphics(path = "JoinedPoints_Lab3.png")
```
